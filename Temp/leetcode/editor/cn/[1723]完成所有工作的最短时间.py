# 1723 å®Œæˆæ‰€æœ‰å·¥ä½œçš„æœ€çŸ­æ—¶é—´
from typing import *


# leetcode submit region begin(Prohibit modification and deletion)
class Solution:
    def minimumTimeRequired(self, jobs: List[int], k: int) -> int:
        def check(m, ji=0):
            # åˆ†é…ä¸‹æ ‡ä¸ºjiçš„å·¥ä½œ
            nonlocal arr
            if ji >= n:  # è¯´æ˜æ‰€æœ‰å·¥ä½œéƒ½èƒ½è¢«åˆ†é…
                return True
            jt = jobs[ji]
            for i, x in enumerate(arr):
                # å°è¯•å°†jobs[ji]åˆ†é…ç»™ç¬¬iä¸ªå·¥äºº
                if x + jt <= m:  # å¯ä»¥åˆ†é…
                    arr[i] += jt
                    if check(m, ji + 1):  # è¿›å…¥ä¸‹ä¸€ä¸ªå·¥ä½œçš„åˆ†é…
                        return True
                    else:  # ä¸‹ä¸€ä¸ªå·¥ä½œä¸èƒ½æˆåŠŸåˆ†é…
                        arr[i] -= jt
                        # å› ä¸ºå·¥ä½œé‡æ˜¯å€’åºæ’åºçš„ï¼Œï¼Œarr[i] == 0è¯´æ˜å½“å‰jiè¿™ä¸ªå·¥ä½œæ­£å¥½æ˜¯mï¼Œæ²¡æœ‰å¿…è¦æ¢ä¸€ä¸ªå·¥äººæ¥åšï¼ˆé€’å½’ï¼‰
                        # å¦ä¸€ä¸ªæ¡ä»¶æ˜¯å®˜è§£é‡Œé¢è¯´çš„ï¼Œä½†æˆ‘ä¸ç†è§£ï¼Œè€Œä¸”æ³¨é‡Šäº†ä¹Ÿä¸å½±å“ï¼Œæ—¶é—´ä¸Šåè€Œæ›´å¥½ä¸€äº›äº›ã€‚
                        if arr[i] == 0:  # or x + jt == m:
                            return False

        n = len(jobs)
        s = sum(jobs)
        if n == 1 or k == 1:
            return s
        jobs.sort(key=lambda x: -x)  # å°†jobså€’åºæ’åºï¼Œä¸ºäº†ä¼˜å…ˆåˆ†é…å·¥ä½œé‡çš„å·¥ä½œ
        l, r = jobs[0], s  # æœ€å¤§å€¼ï¼Œå’Œ
        while l <= r:
            mid = (l + r) // 2
            arr = [0] * k
            if check(mid):
                r = mid - 1
            else:
                l = mid + 1
        return l


# leetcode submit region end(Prohibit modification and deletion)
s = Solution()
# print(s.minimumTimeRequired([3, 2, 3], 3))
# print(s.minimumTimeRequired([1, 2, 4, 7, 8], 2))
print(s.minimumTimeRequired([254, 256, 256, 254, 251, 256, 254, 253, 255, 251, 251, 255], 10))

# ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ jobs ï¼Œå…¶ä¸­ jobs[i] æ˜¯å®Œæˆç¬¬ i é¡¹å·¥ä½œè¦èŠ±è´¹çš„æ—¶é—´ã€‚ 
# 
#  è¯·ä½ å°†è¿™äº›å·¥ä½œåˆ†é…ç»™ k ä½å·¥äººã€‚æ‰€æœ‰å·¥ä½œéƒ½åº”è¯¥åˆ†é…ç»™å·¥äººï¼Œä¸”æ¯é¡¹å·¥ä½œåªèƒ½åˆ†é…ç»™ä¸€ä½å·¥äººã€‚å·¥äººçš„ å·¥ä½œæ—¶é—´ æ˜¯å®Œæˆåˆ†é…ç»™ä»–ä»¬çš„æ‰€æœ‰å·¥ä½œèŠ±è´¹æ—¶é—´çš„æ€»å’Œã€‚è¯·ä½ 
# è®¾è®¡ä¸€å¥—æœ€ä½³çš„å·¥ä½œåˆ†é…æ–¹æ¡ˆï¼Œä½¿å·¥äººçš„ æœ€å¤§å·¥ä½œæ—¶é—´ å¾—ä»¥ æœ€å°åŒ– ã€‚ 
# 
#  è¿”å›åˆ†é…æ–¹æ¡ˆä¸­å°½å¯èƒ½ æœ€å° çš„ æœ€å¤§å·¥ä½œæ—¶é—´ ã€‚ 
# 
#  
# 
#  ç¤ºä¾‹ 1ï¼š 
# 
#  
# è¾“å…¥ï¼šjobs = [3,2,3], k = 3
# è¾“å‡ºï¼š3
# è§£é‡Šï¼šç»™æ¯ä½å·¥äººåˆ†é…ä¸€é¡¹å·¥ä½œï¼Œæœ€å¤§å·¥ä½œæ—¶é—´æ˜¯ 3 ã€‚
#  
# 
#  ç¤ºä¾‹ 2ï¼š 
# 
#  
# è¾“å…¥ï¼šjobs = [1,2,4,7,8], k = 2
# è¾“å‡ºï¼š11
# è§£é‡Šï¼šæŒ‰ä¸‹è¿°æ–¹å¼åˆ†é…å·¥ä½œï¼š
# 1 å·å·¥äººï¼š1ã€2ã€8ï¼ˆå·¥ä½œæ—¶é—´ = 1 + 2 + 8 = 11ï¼‰
# 2 å·å·¥äººï¼š4ã€7ï¼ˆå·¥ä½œæ—¶é—´ = 4 + 7 = 11ï¼‰
# æœ€å¤§å·¥ä½œæ—¶é—´æ˜¯ 11 ã€‚ 
# 
#  
# 
#  æç¤ºï¼š 
# 
#  
#  1 <= k <= jobs.length <= 12 
#  1 <= jobs[i] <= 10â· 
#  
# 
#  Related Topics ä½è¿ç®— æ•°ç»„ åŠ¨æ€è§„åˆ’ å›æº¯ çŠ¶æ€å‹ç¼© ğŸ‘ 322 ğŸ‘ 0
